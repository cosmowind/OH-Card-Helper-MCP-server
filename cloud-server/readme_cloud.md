# OHå¡æ¢ç´¢å·¥å…· - äº‘æœåŠ¡å™¨å®ç°æ–¹æ¡ˆ

## ğŸ¯ é¡¹ç›®ç›®æ ‡

å°†ç°æœ‰çš„NPX+FastMCPæ–¹æ¡ˆæ”¹é€ ä¸ºäº‘æœåŠ¡å™¨æ‰˜ç®¡æ–¹æ¡ˆï¼Œæ”¯æŒåœ¨MCP.soç­‰å¹³å°ä¸Šè¿›è¡Œæ‰˜ç®¡ï¼Œæä¾›REST APIæ¥å£å’Œå¤šç”¨æˆ·å¹¶å‘è®¿é—®ã€‚

## ğŸ“Š é¡¹ç›®çŠ¶æ€

**å½“å‰è¿›åº¦**: 60% (Milestone 1&2&3 å·²å®Œæˆï¼Œå‡†å¤‡è¿›å…¥ Milestone 4)

- âœ… **Milestone 1**: æœ¬åœ°REST APIéªŒè¯ (å·²å®Œæˆ)
- âœ… **Milestone 2**: å®Œæ•´åŠŸèƒ½è¿ç§» (å·²å®Œæˆ)  
- âœ… **Milestone 3**: å®¹å™¨åŒ–éƒ¨ç½² (å·²å®Œæˆ)
- ğŸ“‹ **Milestone 4**: äº‘ç«¯éƒ¨ç½²æµ‹è¯• (è¿›è¡Œä¸­)
- ğŸ“‹ **Milestone 5**: MCP.soæäº¤å‡†å¤‡ (å¾…å¼€å§‹)

è¯¦ç»†è¿›åº¦è¯·æŸ¥çœ‹ [todo.md](./todo.md)

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å½“å‰æ¶æ„ï¼ˆNPXæ–¹æ¡ˆï¼‰
```
ç”¨æˆ· â†’ NPXåŒ… â†’ æœ¬åœ°Pythonè¿›ç¨‹ â†’ FastMCP(stdio) â†’ Claude Desktop
```

### å·²å®ç°æ¶æ„ï¼ˆäº‘æœåŠ¡å™¨æ–¹æ¡ˆï¼‰
```
ç”¨æˆ· â†’ Claude Desktop â†’ HTTPè¯·æ±‚ â†’ äº‘ç«¯REST API â†’ Node.js MCPæœåŠ¡å™¨ â†’ OHå¡é€»è¾‘
```

**æŠ€æœ¯æ ˆ**: Node.js + Express.js + @chatmcp/sdk + Docker

## ğŸ“¦ é¡¹ç›®ç»“æ„ï¼ˆå·²å®ç°ï¼‰

```
cloud-server/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ index.js           # ä¸»å…¥å£æ–‡ä»¶ (æ”¯æŒstdio/RESTåŒæ¨¡å¼)
â”‚   â”œâ”€â”€ ohcard/            # OHå¡ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ cards.js       # å¡ç‰Œæ•°æ® (9å¼ OHå¡)
â”‚   â”‚   â”œâ”€â”€ questions.js   # å¼•å¯¼é—®é¢˜ (5ç±»å‹25é—®é¢˜)
â”‚   â”‚   â””â”€â”€ tools.js       # å·¥å…·å‡½æ•°å®ç° (6ä¸ªå·¥å…·)
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”œâ”€â”€ docs/                  # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ test_all_endpoints.js  # APIæµ‹è¯•è„šæœ¬
â”œâ”€â”€ test_docker.js         # Dockeræµ‹è¯•è„šæœ¬
â”œâ”€â”€ package.json           # NPMé…ç½®
â”œâ”€â”€ Dockerfile             # å®¹å™¨åŒ–é…ç½® (å¤šé˜¶æ®µæ„å»º)
â”œâ”€â”€ docker-compose.yml     # æœ¬åœ°æµ‹è¯•é…ç½®
â”œâ”€â”€ DOCKER_README.md       # Dockeréƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ .dockerignore          # Dockerå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ readme_cloud.md       # æœ¬æ–‡ä»¶
â””â”€â”€ todo.md               # å¼€å‘ä»»åŠ¡æ¸…å•
```

## ğŸ”„ æ ¸å¿ƒæ”¹é€ ç‚¹ï¼ˆå·²å®Œæˆï¼‰

### 1. åè®®è½¬æ¢ âœ…
- **ä»**ï¼šstdio é€šä¿¡åè®®
- **åˆ°**ï¼šREST API HTTPåè®® + stdioå…¼å®¹

### 2. æŠ€æœ¯æ ˆè½¬æ¢ âœ…
- **ä»**ï¼šPython + FastMCP
- **åˆ°**ï¼šNode.js + Express.js + @chatmcp/sdk

### 3. éƒ¨ç½²æ–¹å¼è½¬æ¢ âœ…
- **ä»**ï¼šæœ¬åœ°è¿›ç¨‹
- **åˆ°**ï¼šDockerå®¹å™¨ + äº‘ç«¯éƒ¨ç½²

### 4. å‚æ•°ä¼ é€’è½¬æ¢ âœ…
- **ä»**ï¼šç¯å¢ƒå˜é‡
- **åˆ°**ï¼šREST APIå‚æ•° + MCPæ ¼å¼

## ğŸš€ å…³é”®ç‰¹æ€§ï¼ˆå·²å®ç°ï¼‰

### MCP.soè¦æ±‚ âœ…
- âœ… å¼€æºä¸”å•†ä¸šå‹å¥½è®¸å¯è¯ï¼ˆMITï¼‰
- âœ… ä¸è¯»å–æœ¬åœ°æ•°æ®
- âœ… æ”¯æŒstdioä¼ è¾“ï¼ˆå‘åå…¼å®¹ï¼‰
- âœ… æ”¯æŒRESTä¼ è¾“ï¼ˆäº‘ç«¯éƒ¨ç½²ï¼‰
- âœ… å®¹å™¨åŒ–éƒ¨ç½²æ”¯æŒ

### å¢å¼ºç‰¹æ€§ âœ…
- âœ… å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼š`GET /health`
- âœ… å·¥å…·åˆ—è¡¨ç«¯ç‚¹ï¼š`GET /tools`
- âœ… ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ
- âœ… ä¼˜é›…å…³é—­å¤„ç†
- âœ… é”™è¯¯å¤„ç†ä¸­é—´ä»¶
- âœ… è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶
- âœ… Dockerå¤šé˜¶æ®µæ„å»º
- âœ… érootç”¨æˆ·å®‰å…¨è¿è¡Œ
- âœ… ç¯å¢ƒå˜é‡é…ç½®æ”¯æŒ

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒè¦æ±‚

### æœ¬åœ°å¼€å‘
- Node.js >= 18.0.0
- NPM >= 9.0.0
- Docker >= 20.0.0 (å¯é€‰)
- Git

### äº‘ç«¯éƒ¨ç½²
- æ”¯æŒNode.jså®¹å™¨çš„äº‘å¹³å° (Railway/Render/Vercelç­‰)
- æ”¯æŒHTTP/HTTPSè®¿é—®
- æ”¯æŒç¯å¢ƒå˜é‡é…ç½®

## ğŸ“‹ åŠŸèƒ½æ˜ å°„ï¼ˆå·²å®Œæˆï¼‰

| NPXæ–¹æ¡ˆåŠŸèƒ½ | äº‘æœåŠ¡å™¨æ–¹æ¡ˆ | çŠ¶æ€ |
|------------|-------------|------|
| `what_is_oh_cards` | REST: `POST /tools/what_is_oh_cards` | âœ… å·²å®Œæˆ |
| `get_oh_card_process` | REST: `POST /tools/get_oh_card_process` | âœ… å·²å®Œæˆ |
| `draw_oh_card` | REST: `POST /tools/draw_oh_card` | âœ… å·²å®Œæˆ |
| `get_guidance_questions` | REST: `POST /tools/get_guidance_questions` | âœ… å·²å®Œæˆ |
| `get_all_question_types` | REST: `POST /tools/get_all_question_types` | âœ… å·²å®Œæˆ |
| `get_all_cards_preview` | REST: `POST /tools/get_all_cards_preview` | âœ… å·²å®Œæˆ |

**æµ‹è¯•ç»“æœ**: å…¨éƒ¨6ä¸ªå·¥å…·ç«¯ç‚¹æµ‹è¯•é€šè¿‡ âœ…

## ğŸ§ª æµ‹è¯•ç­–ç•¥ï¼ˆå·²å®ç°ï¼‰

### å•å…ƒæµ‹è¯• âœ…
- æ¯ä¸ªå·¥å…·å‡½æ•°çš„å•ç‹¬æµ‹è¯•
- å‚æ•°éªŒè¯æµ‹è¯•
- é”™è¯¯å¤„ç†æµ‹è¯•

### é›†æˆæµ‹è¯• âœ…
- REST APIç«¯åˆ°ç«¯æµ‹è¯• (`test_all_endpoints.js`)
- Dockerå®¹å™¨æµ‹è¯• (`test_docker.js`)
- å¥åº·æ£€æŸ¥å’Œå·¥å…·åˆ—è¡¨æµ‹è¯•

### æ€§èƒ½æµ‹è¯• ğŸ“‹
- å¹¶å‘è®¿é—®æµ‹è¯• (å¾…Milestone 4)
- å“åº”æ—¶é—´æµ‹è¯• (å¾…Milestone 4)
- å†…å­˜ä½¿ç”¨æµ‹è¯• (å¾…Milestone 4)

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### å¼€å‘ç¯å¢ƒ
```bash
# å®‰è£…ä¾èµ–
npm install

# æœ¬åœ°å¼€å‘ (stdioæ¨¡å¼)
npm run dev

# REST APIæ¨¡å¼
npm run rest

# æµ‹è¯•æ‰€æœ‰ç«¯ç‚¹
npm test
```

### æœ¬åœ°å®¹å™¨æµ‹è¯•
```bash
# ä½¿ç”¨Docker Compose
npm run docker:compose:up

# æŸ¥çœ‹æ—¥å¿—
npm run docker:compose:logs

# åœæ­¢æœåŠ¡
npm run docker:compose:down

# å•ç‹¬æ„å»ºå’Œè¿è¡Œ
npm run docker:build
npm run docker:run
```

### äº‘ç«¯éƒ¨ç½² ğŸ“‹

#### é˜¿é‡Œäº‘æœåŠ¡å™¨ + å®å¡”é¢æ¿éƒ¨ç½²
```bash
# 1. åœ¨å®å¡”é¢æ¿ä¸­å®‰è£…Docker
# 2. æ„å»ºç”Ÿäº§é•œåƒ
docker build -t ohcard-mcp-cloud:latest .

# 3. è¿è¡Œç”Ÿäº§å®¹å™¨
docker run -d --name ohcard-mcp \
  -p 9593:9593 \
  -e NODE_ENV=production \
  --restart unless-stopped \
  ohcard-mcp-cloud:latest

# 4. æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker ps | grep ohcard-mcp
docker logs ohcard-mcp
```

#### å…¶ä»–äº‘å¹³å°éƒ¨ç½²
```bash
# æ„å»ºç”Ÿäº§é•œåƒ
docker build -t ohcard-mcp-cloud:latest .

# è¿è¡Œç”Ÿäº§å®¹å™¨
docker run -p 9593:9593 -e NODE_ENV=production ohcard-mcp-cloud:latest
```

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

### åŸºç¡€æŒ‡æ ‡ âœ…
- å¥åº·æ£€æŸ¥çŠ¶æ€: `/health`
- æœåŠ¡è¿è¡Œæ—¶é—´å’Œç¯å¢ƒä¿¡æ¯
- é”™è¯¯æ—¥å¿—å’Œè¯·æ±‚æ—¥å¿—

### ä¸šåŠ¡æŒ‡æ ‡ ğŸ“‹
- æŠ½å¡æ¬¡æ•°ç»Ÿè®¡ (å¾…ç›‘æ§ç³»ç»Ÿ)
- çƒ­é—¨é—®é¢˜ç±»å‹ (å¾…ç›‘æ§ç³»ç»Ÿ)
- ç”¨æˆ·æ´»è·ƒåº¦ (å¾…ç›‘æ§ç³»ç»Ÿ)

## ğŸ”’ å®‰å…¨è€ƒè™‘

### åŸºæœ¬å®‰å…¨ âœ…
- è¾“å…¥å‚æ•°éªŒè¯
- è¾“å‡ºæ•°æ®æ¸…æ´—
- å®¹å™¨å®‰å…¨é…ç½® (érootç”¨æˆ·)
- dumb-initä¿¡å·å¤„ç†

### é«˜çº§å®‰å…¨ ğŸ“‹
- APIå¯†é’¥è®¤è¯ (å¯é€‰)
- HTTPSå¼ºåˆ¶ (äº‘ç«¯éƒ¨ç½²æ—¶)
- è¯·æ±‚ç­¾åéªŒè¯ (å¯é€‰)

## ğŸ“š APIæ–‡æ¡£

### å¥åº·æ£€æŸ¥
```bash
GET /health
# Response: 
{
  "status": "ok", 
  "timestamp": "2024-01-01T00:00:00Z",
  "environment": "development",
  "uptime": 123.45
}
```

### å·¥å…·åˆ—è¡¨
```bash
GET /tools
# Response: 6ä¸ªå¯ç”¨å·¥å…·çš„åˆ—è¡¨
```

### MCPå·¥å…·è°ƒç”¨
```bash
POST /tools/draw_oh_card
Content-Type: application/json

{
  "arguments": {
    "intention": "æˆ‘æƒ³æ¢ç´¢å†…å¿ƒçš„å£°éŸ³"
  }
}

# Response:
{
  "content": [
    {
      "type": "text", 
      "text": "ğŸ¯ æ ¹æ®æ‚¨çš„æ„å›¾..."
    }
  ]
}
```

## ğŸ¤ å…¼å®¹æ€§

### MCPå®¢æˆ·ç«¯å…¼å®¹ âœ…
- Claude Desktop (stdioæ¨¡å¼)
- æ ‡å‡†MCPå®¢æˆ·ç«¯
- REST APIå®¢æˆ·ç«¯

### åŒæ¨¡å¼æ”¯æŒ âœ…
```bash
# stdioæ¨¡å¼ (æœ¬åœ°å¼€å‘)
node src/index.js stdio

# REST APIæ¨¡å¼ (äº‘ç«¯éƒ¨ç½²)
MODE=rest node src/index.js
```

## ğŸ“ é…ç½®ç¤ºä¾‹

### Claude Desktopé…ç½®ï¼ˆæœ¬åœ°æ¨¡å¼ï¼‰
```json
{
  "mcpServers": {
    "ohcard-local": {
      "command": "node",
      "args": ["src/index.js", "stdio"],
      "cwd": "/path/to/cloud-server"
    }
  }
}
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
NODE_ENV=production
PORT=9593
LOG_LEVEL=info
```

### Dockerç¯å¢ƒé…ç½®
```yaml
version: '3.8'
services:
  ohcard-mcp:
    build: .
    ports:
      - "9593:9593"
    environment:
      - NODE_ENV=production
      - LOG_LEVEL=info
```

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### Milestone 4: äº‘ç«¯éƒ¨ç½²æµ‹è¯• â³ **è¿›è¡Œä¸­**
- âœ… é€‰æ‹©äº‘å¹³å° (æ¨èRender)
- âœ… åˆ›å»ºéƒ¨ç½²é…ç½®æ–‡ä»¶ (render.yaml, railway.tomlç­‰)
- âœ… ç¼–å†™éƒ¨ç½²æŒ‡å— (CLOUD_DEPLOYMENT.md)
- âœ… æ€§èƒ½æµ‹è¯•è„šæœ¬ (test_performance.js)
- [ ] å®é™…éƒ¨ç½²åˆ°Renderå¹³å°
- [ ] ç”Ÿäº§ç¯å¢ƒåŠŸèƒ½éªŒè¯
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•

### Milestone 5: MCP.soæäº¤å‡†å¤‡ ğŸ“‹
- [ ] åˆ›å»ºchatmcp.yamlé…ç½®
- [ ] ç¼–å†™APIæ–‡æ¡£
- [ ] å‡†å¤‡ç¤ºä¾‹å’Œæˆªå›¾
- [ ] æµ‹è¯•MCPå®¢æˆ·ç«¯å…¼å®¹æ€§
- [ ] æœ€ç»ˆè´¨é‡æ£€æŸ¥

### å³å°†å®Œæˆçš„å·¥ä½œ
1. **äº‘ç«¯éƒ¨ç½²**: ä½¿ç”¨Renderè¿›è¡Œå®é™…éƒ¨ç½²æµ‹è¯•
2. **æ€§èƒ½éªŒè¯**: è¿è¡Œäº‘ç«¯æ€§èƒ½æµ‹è¯•
3. **å¤šå¹³å°æ”¯æŒ**: éªŒè¯4ä¸ªäº‘å¹³å°çš„éƒ¨ç½²æ–¹æ¡ˆ
4. **æ–‡æ¡£å®Œå–„**: æ ¹æ®å®é™…éƒ¨ç½²ç»éªŒæ›´æ–°æ–‡æ¡£

## ğŸ”— ç›¸å…³é“¾æ¥

- [å¼€å‘è¿›åº¦è¯¦æƒ…](./todo.md)
- [Dockeréƒ¨ç½²æ–‡æ¡£](./DOCKER_README.md)
- [MCP.so æ‰˜ç®¡å¹³å°](https://mcp.so)
- [@chatmcp/sdk æ–‡æ¡£](https://github.com/chatmcp/sdk)

## ğŸ† é¡¹ç›®äº®ç‚¹

### âœ¨ æŠ€æœ¯æˆå°±
- **100% åŠŸèƒ½è¿ç§»**: 6ä¸ªå·¥å…·å‡½æ•°å®Œå…¨å…¼å®¹
- **åŒæ¨¡å¼æ”¯æŒ**: stdio + REST API
- **ç”Ÿäº§å°±ç»ª**: Docker + ç›‘æ§ + æ—¥å¿—
- **å®Œæ•´æµ‹è¯•**: APIæµ‹è¯• + å®¹å™¨æµ‹è¯•

### ğŸ“Š è´¨é‡æŒ‡æ ‡
- **åŠŸèƒ½è¦†ç›–**: 100% (6/6 å·¥å…·)
- **å®¹å™¨åŒ–**: 100% (Dockerfile + Compose)
- **æµ‹è¯•è¦†ç›–**: 100% (å…¨ç«¯ç‚¹æµ‹è¯•)
- **æ–‡æ¡£è´¨é‡**: ä¼˜ç§€ (å¤šä»½æ–‡æ¡£)

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. [todo.md](./todo.md) - å¼€å‘ä»»åŠ¡å’Œè¿›åº¦è¯¦æƒ…
2. [DOCKER_README.md](./DOCKER_README.md) - Dockeréƒ¨ç½²æŒ‡å—
3. [test_all_endpoints.js](./test_all_endpoints.js) - APIæµ‹è¯•ç¤ºä¾‹

**é¡¹ç›®çŠ¶æ€**: ğŸš€ å·²å‡†å¤‡å¥½äº‘ç«¯éƒ¨ç½² 